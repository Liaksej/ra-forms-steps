(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1732:function(e,a,t){Promise.resolve().then(t.bind(t,113))},113:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return b}});var d=t(97),i=t(402),l=t(8699),n=t(7354);function r(e){console.log(e);let a=e.split(".");return new Date(Number(a[2]),Number(a[1])-1,Number(a[0]))}let s=e=>/^([0-2][0-9]|(3)[0-1])\.(((0)[0-9])|((1)[0-2]))\.\d{2}(1[1-9]|2[0-9])$/.test(e),o=e=>!isNaN(e)&&e>0,c=e=>{let{dispatch:a,editedRow:t,formFields:r,validatedFormFields:c}=e;return(0,d.jsxs)("form",{id:"form",className:"p-4 flex gap-2",onSubmit:e=>{e.preventDefault();let t=e.currentTarget,d=t.elements.namedItem("date"),i=t.elements.namedItem("distance"),l=null==d?void 0:d.value,n=Number(null==i?void 0:i.value);if(s(l))a({type:"validateFormFields",payload:{date:!0}});else{a({type:"validateFormFields",payload:{date:"Введите дату в формате ДД.ММ.ГГ"}});return}if(o(n))a({type:"validateFormFields",payload:{distance:!0}});else{a({type:"validateFormFields",payload:{distance:"Введите число"}});return}a({type:"addNewRow",payload:{date:l,distance:n}}),a({type:"changeFormFields",payload:{date:"",distance:""}})},children:[(0,d.jsxs)("div",{className:"date-field",children:[(0,d.jsx)(i.Z,{name:"date",id:"outlined-basic",label:"Дата (ДД.ММ.ГГ)",variant:"outlined",required:!0,value:t&&t.data?t.data.date:r.date,onChange:e=>{t&&t.data?a({type:"changeDate",payload:e.target.value}):a({type:"changeFormFields",payload:{...r,date:e.target.value}})}}),(0,d.jsx)(l.Z,{error:!0,children:c.date})]}),(0,d.jsxs)("div",{className:"distance-field",children:[(0,d.jsx)(i.Z,{name:"distance",id:"outlined-basic",label:"Пройдено км",variant:"outlined",required:!0,value:t&&t.data?t.data.distance:r.distance,onChange:e=>{t&&t.data?a({type:"changeDistance",payload:e.target.value}):a({type:"changeFormFields",payload:{...r,distance:e.target.value}})}}),(0,d.jsx)(l.Z,{error:!0,children:c.distance})]}),(0,d.jsx)(n.Z,{variant:"outlined",className:"h-[56px]",type:"submit",children:"Ok"})]})};var u=t(850),m=t(4572),h=t(6175),p=t(6870),v=t(8125),w=t(8865),x=t(886),f=t(7838),y=t(3696);let g=[{id:"date",label:"Дата\xa0(ДД.ММ.ГГ)",minWidth:170,align:"left"},{id:"distance",label:"Пройдено\xa0км",minWidth:170,align:"center"},{id:"actions",label:"Действия",minWidth:170,align:"right"}],F=e=>{let{rows:a,dispatch:t}=e,i=e=>{var a;e.preventDefault();let d=e.target.closest("tr"),i=null==d?void 0:null===(a=d.firstElementChild)||void 0===a?void 0:a.textContent;t({type:"deleteRow",payload:i})},l=e=>{var a;e.preventDefault();let d=e.target.closest("tr"),i=null==d?void 0:null===(a=d.firstElementChild)||void 0===a?void 0:a.textContent;t({type:"editRow",payload:i})};return(0,d.jsx)(u.Z,{sx:{width:"100%",overflow:"hidden"},children:(0,d.jsxs)(m.Z,{sx:{maxHeight:1111},children:[(0,d.jsx)(h.Z,{children:(0,d.jsx)(p.Z,{children:g.map(e=>(0,d.jsx)(v.Z,{align:e.align,style:{minWidth:e.minWidth},children:e.label},e.id))})}),(0,d.jsx)(w.Z,{children:a.map(e=>(0,d.jsx)(p.Z,{hover:!0,role:"checkbox",tabIndex:-1,sx:{"&:last-child td, &:last-child th":{border:0}},children:g.map(a=>{let t=e[a.id];return"actions"===a.id&&(t=void 0),"date"===a.id&&(t=e.date),(0,d.jsx)(v.Z,{align:a.align,style:{minWidth:a.minWidth},children:void 0===t?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(x.Z,{"aria-label":"edit",size:"small",onClick:e=>l(e),children:(0,d.jsx)(f.Z,{})}),(0,d.jsx)(x.Z,{"aria-label":"clear",size:"small",onClick:e=>i(e),children:(0,d.jsx)(y.Z,{})})]}):t},a.id)})},e.date))})]})})};var j=t(1595);function R(e,a){var t,d;switch(a.type){case"addNewRow":if(e.editedRow){let t=[...e.rows];return t[e.editedRow.index]=a.payload,{...e,rows:t.sort((e,a)=>r(e.date).getTime()-r(a.date).getTime()),editedRow:null}}{let t=e.rows.find(e=>e.date===a.payload.date);if(t)return{...e,rows:e.rows.map(e=>e.date===a.payload.date?{...e,distance:e.distance+a.payload.distance}:e)};return{...e,rows:[...e.rows,a.payload].sort((e,a)=>r(e.date).getTime()-r(a.date).getTime())}}case"deleteRow":return{...e,rows:e.rows.filter(e=>e.date!==a.payload)};case"editRow":let i=e.rows.findIndex(e=>e.date===a.payload);return{...e,editedRow:{data:e.rows[i],index:i}};case"changeDate":if(!e.editedRow)return e;return{...e,editedRow:{...e.editedRow,data:{...null===(t=e.editedRow)||void 0===t?void 0:t.data,date:a.payload}}};case"changeDistance":if(!e.editedRow)return e;return{...e,editedRow:{...e.editedRow,data:{...null===(d=e.editedRow)||void 0===d?void 0:d.data,distance:a.payload}}};case"changeFormFields":return{...e,formFields:a.payload};case"validateFormFields":return{...e,validatedFormFields:a.payload};default:return e}}function b(){let[e,a]=(0,j.useReducer)(R,{rows:[],editedRow:null,formFields:{date:"",distance:""},validatedFormFields:{date:!0,distance:!0}});return(0,d.jsxs)("div",{className:"flex h-screen justify-start flex-col w-fit mx-auto",children:[(0,d.jsx)(c,{rows:e.rows,editedRow:e.editedRow,formFields:e.formFields,validatedFormFields:e.validatedFormFields,dispatch:a}),(0,d.jsx)(F,{rows:e.rows,editedRow:e.editedRow,dispatch:a})]})}}},function(e){e.O(0,[697,120,244,744],function(){return e(e.s=1732)}),_N_E=e.O()}]);